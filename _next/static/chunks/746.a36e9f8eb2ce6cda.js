"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{4746:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Q});var a=t(5155),l=t(2115),r=t(3463),n=t(9795);function o(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,n.QP)((0,r.$)(s))}let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("rounded-xl border bg-card text-card-foreground shadow",t),...l})});i.displayName="Card",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("flex flex-col space-y-1.5 p-6",t),...l})}).displayName="CardHeader",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("font-semibold leading-none tracking-tight",t),...l})}).displayName="CardTitle",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("text-sm text-muted-foreground",t),...l})}).displayName="CardDescription",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("p-6 pt-0",t),...l})}).displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:o("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter";var d=t(2317);let c=(0,t(1027).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=l.forwardRef((e,s)=>{let{className:t,variant:l,size:r,asChild:n=!1,...i}=e,u=n?d.DX:"button";return(0,a.jsx)(u,{className:o(c({variant:l,size:r,className:t})),ref:s,...i})});u.displayName="Button";var m=t(8281),f=t(8346),p=t(7193),h=t(2783),x=t(5325),g=t(5012),v=t(4683),j=t(8209),b=t(689),N=t(6756),y=t(833),w=t(9407);t(8413),t(8576),t(4609);var k=t(8741),C=t.n(k),R=t(5461);let E=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsxs)(R.bL,{ref:s,className:o("relative flex w-full touch-none select-none items-center",t),...l,children:[(0,a.jsx)(R.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(R.Q6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(R.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}),(0,a.jsx)(R.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});E.displayName=R.bL.displayName,t(8357);var S=t(7859);let z=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.uB,{ref:s,className:o("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...l})});z.displayName=S.uB.displayName;let A=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.uB.Input,{ref:s,className:o("flex h-10 w-full rounded-md bg-transparent py-3 px-4 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...l})});A.displayName=S.uB.Input.displayName;let M=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.uB.List,{ref:s,className:o("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...l})});M.displayName=S.uB.List.displayName;let T=l.forwardRef((e,s)=>(0,a.jsx)(S.uB.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));T.displayName=S.uB.Empty.displayName;let I=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.uB.Group,{ref:s,className:o("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...l})});I.displayName=S.uB.Group.displayName;let B=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.uB.Item,{ref:s,className:o("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled='true']:pointer-events-none data-[disabled='true']:opacity-50",t),...l})});B.displayName=S.uB.Item.displayName;var F=t(1556);let D=F.bL,L=F.l9,P=F.ZL;F.bm;let _=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(F.hJ,{ref:s,className:o("fixed inset-0 z-[2000] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});_.displayName=F.hJ.displayName;let O=l.forwardRef((e,s)=>{let{className:t,children:l,...r}=e;return(0,a.jsxs)(P,{children:[(0,a.jsx)(_,{}),(0,a.jsxs)(F.UC,{ref:s,className:o("fixed left-[50%] top-[50%] z-[2001] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[l,(0,a.jsxs)(F.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});O.displayName=F.UC.displayName;let U=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:o("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};U.displayName="DialogHeader";let Z=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(F.hE,{ref:s,className:o("text-lg font-semibold leading-none tracking-tight",t),...l})});Z.displayName=F.hE.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(F.VY,{ref:s,className:o("text-sm text-muted-foreground",t),...l})}).displayName=F.VY.displayName;let V=e=>{console.log("Starting GEDCOM parsing...");let s=e.split("\n");console.log("Total lines to process: ".concat(s.length));let t=[],a=[],l=null,r=null,n=null;return s.forEach(e=>{let s=e.trim().split(/\s+/);if(s.length<2)return;let o=s[0],i=s[1],d=s.slice(2).join(" ");if("0"===o)s.length>2&&("INDI"===s[2]?(l&&t.push(l),l={id:s[1].replace(/@/g,""),name:"Unknown",sex:null,events:[],parents:[],children:[],spouses:[]},r=null):"FAM"===s[2]&&(r&&a.push(r),r={id:s[1].replace(/@/g,""),spouses:[],children:[]},l=null));else if(l){if("NAME"===i)l.name=d.replace(/\//g,""),console.log("Found name: ".concat(l.name));else if(["BIRT","DEAT","RESI"].includes(i))n={type:i,date:{year:null},place:"Unknown",coordinates:[0,0]},l.events.push(n),console.log("Found event ".concat(i," for ").concat(l.name));else if("CHAN"===i)n=null;else if("DATE"===i&&n){if(["BIRT","DEAT","RESI"].includes(n.type)){let e=d.match(/FROM (\d{4}) TO (\d{4})/i);if(e)n.date={from:e[1],to:e[2],year:parseInt(e[1])};else{let e=d.match(/(\d{1,2}\s+[A-Za-z]+\s+)?(\d{4})/);if(e){let s=parseInt(e[2]);n.date={from:d.trim(),year:s}}}}}else if("PLAC"===i&&n)!d||/^\d+$/.test(d)?n.place="Unknown":n.place=d,n.coordinates=[0,0];else if("MAP"===i)n&&(n.coordinates=[0,0]);else if("LATI"===i&&n){let e=d.match(/([NS])(\d+\.\d+)/);if(e){let s=parseFloat(e[2])*("S"===e[1]?-1:1);n.coordinates[0]=s}}else if("LONG"===i&&n){let e=d.match(/([EW])(\d+\.\d+)/);if(e){let s=parseFloat(e[2])*("W"===e[1]?-1:1);n.coordinates[1]=s}}else"SEX"===i&&(l.sex=d)}else r&&(["HUSB","WIFE"].includes(i)?r.spouses.push(d.replace(/@/g,"")):"CHIL"===i&&r.children.push(d.replace(/@/g,"")))}),l&&t.push(l),r&&a.push(r),a.forEach(e=>{e.children.forEach(s=>{let a=t.find(e=>e.id===s);a&&(a.parents.push(...e.spouses),e.spouses.forEach(a=>{let l=t.find(e=>e.id===a);l&&(l.children.push(s),l.spouses.push(...e.spouses.filter(e=>e!==a)))}))})}),console.log("Parsing complete. Found ".concat(t.length," people")),console.log("Sample of parsed data:",t.slice(0,2)),t};function G(e){let{events:s,onSelect:t,activeCoordinates:a}=e,r=(0,N.ko)(),n=(0,l.useRef)(new Map);return(0,l.useEffect)(()=>{let e=(e,s)=>({radius:null!=s&&s?10:8,fillColor:"BIRT"===e.type?"#15803d":"DEAT"===e.type?"#b91c1c":"#1d4ed8",color:"white",weight:2,opacity:1,fillOpacity:.9,className:"hover:cursor-pointer"}),l=new(C()).MarkerClusterGroup({spiderfyOnMaxZoom:!0,zoomToBoundsOnClick:!0,disableClusteringAtZoom:10,maxClusterRadius:40,iconCreateFunction:function(e){let s=new Set(e.getAllChildMarkers().map(e=>{let s=e.getLatLng();return"".concat(s.lat,",").concat(s.lng)})).size,t="small";return s>100?t="large":s>10&&(t="medium"),C().divIcon({html:"<div><span>".concat(s,"</span></div>"),className:"marker-cluster marker-cluster-".concat(t),iconSize:C().point(40,40)})}}),o=n.current;if(s.forEach(s=>{let{person:r,event:o}=s,i=a&&a[0]===o.coordinates[0]&&a[1]===o.coordinates[1],d=C().circleMarker([o.coordinates[0],o.coordinates[1]],e(o,i)).on("click",e=>{C().DomEvent.stopPropagation(e),t(r,o)}),c="".concat(o.coordinates[0],",").concat(o.coordinates[1]);n.current.set(c,d),l.addLayer(d)}),r.addLayer(l),a){let e="".concat(a[0],",").concat(a[1]),s=n.current.get(e);if(s){s.setStyle({pane:"markerPane",radius:10,fillOpacity:1}),r.setView(a,14);let e=s.getElement();e&&(e.classList.add("marker-bounce"),setTimeout(()=>{e.classList.remove("marker-bounce")},2e3))}}return()=>{r.removeLayer(l),o.clear()}},[r,s,t,a]),null}function H(e){let{coordinates:s,onClick:t}=e;return(0,a.jsxs)("button",{onClick:t,className:"text-blue-600 hover:text-blue-800 p-1 rounded-full hover:bg-blue-50",title:"View location (".concat(s[0],", ").concat(s[1],") on map"),children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),(0,a.jsx)("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),(0,a.jsx)("span",{className:"sr-only",children:"View on map"})]})}function W(e){let{coordinates:s,zoom:t}=e,a=(0,N.ko)();return(0,l.useEffect)(()=>{s&&a.setView(s,t||a.getZoom())},[s,t,a]),null}function Q(){var e;let[s,t]=(0,l.useState)([]),[r,n]=(0,l.useState)([1800,2024]),[d,c]=(0,l.useState)(null),N=(0,l.useRef)(null),[k,C]=(0,l.useState)(null),[R,S]=(0,l.useState)(new Map),[F,P]=(0,l.useState)(""),[_,Q]=(0,l.useState)(!1),[Y,$]=(0,l.useState)(null),[J,X]=(0,l.useState)(["BIRT","DEAT","RESI"]),[q,K]=(0,l.useState)("all"),[ee,es]=(0,l.useState)(!1),[et,ea]=(0,l.useState)(null),[el,er]=(0,l.useState)(!1),en=(0,l.useRef)(null),eo=l.useMemo(()=>s.flatMap(e=>{if(k&&"all"!==q){let s=R.get(e.id);if(!s||"Not Related"===s||"Root Person"===s)return[];if("ancestors"===q){let e=/[sd]/.test(s),t=/[fm]/.test(s);if(e||!t)return[]}if("descendants"===q){let e=/[fm]/.test(s),t=/[sd]/.test(s);if(e||!t)return[]}}return e.events.filter(e=>null!==e.date.year&&e.date.year>=r[0]&&e.date.year<=r[1]&&0!==e.coordinates[0]&&0!==e.coordinates[1]&&"Unknown"!==e.place&&J.includes(e.type)).map(s=>({person:e,event:s}))}),[s,r,J,k,q,R]);(0,l.useEffect)(()=>{!async function(){if(k&&s.length>0){es(!0);try{await new Promise(e=>setTimeout(e,0));let e=function(e,s){let t=new Map(e.map(e=>[e.id,e])),a=new Map;return e.forEach(e=>{if(e.id===s){a.set(e.id,"Root Person");return}let l=function e(s,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(s===a)return[s];if(l.has(s))return null;l.add(s);let n=t.get(s);if(!n)return null;if(null===r||"up"===r)for(let t of n.parents){let r=e(t,a,new Set(l),"up");if(r)return[s,...r]}if(null===r||"down"===r)for(let t of n.children){let r=e(t,a,new Set(l),"down");if(r)return[s,...r]}return null}(e.id,s);if(!l){a.set(e.id,"Not Related");return}a.set(e.id,function(e){let s=[],a=e[0];for(let l=1;l<e.length;l++){let r=t.get(a),n=t.get(e[l]);if(r&&n){if(n.spouses.includes(a))return"F"===n.sex?"Wife":"Husband";n.children.includes(a)?s.push("F"===n.sex?"m":"f"):r.children.includes(e[l])&&s.push("F"===n.sex?"d":"s"),a=e[l]}}let l=s.join("").replace(/(.{2})/g,"$1 ").trim();return({f:"Far",m:"Mor",s:"Son",d:"Dotter","f f":"Farfar","f m":"Farmor","m f":"Morfar","m m":"Mormor","s s":"Sonson","s d":"Sondotter","d s":"Dotterson","d d":"Dotterdotter","f f f":"Farfarsfar","f f m":"Farfarsmor","f m f":"Farmorsfar","f m m":"Farmorsmor","m f f":"Morfarsfar","m f m":"Morfarsmor","m m f":"Mormorsfar","m m m":"Mormorsmor"})[l]||l}(l.reverse()))}),a}(s,k);S(e),K("all")}finally{es(!1)}}else S(new Map)}()},[k,s]);let ei=e=>R.get(e),ed=l.useMemo(()=>{if(!F)return s;let e=F.toLowerCase().trim().split(/\s+/);return s.filter(s=>{let t=s.name.toLowerCase();return e.every(e=>t.includes(e))}).sort((e,s)=>e.name.localeCompare(s.name))},[s,F]),ec=(e,s)=>{$({coordinates:e,zoom:s?s+2:14}),ea(e),setTimeout(()=>{ea(null)},2e3)};return(0,a.jsxs)("div",{className:"h-screen w-screen overflow-hidden relative",children:[(0,a.jsxs)("div",{className:o("absolute top-4 right-4 z-[1000] transition-transform duration-200",el?"translate-x-[calc(100%-3rem)]":"bg-white rounded-lg shadow-lg"),children:[(0,a.jsx)("div",{className:o("p-4",el?"hidden":""),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("input",{type:"file",ref:N,onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a){console.log("No file selected");return}console.log("File selected:",a.name);let l=new FileReader;l.onload=e=>{try{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result;console.log("File content length:",a.length);let l=V(a);console.log("Parsed people:",l.length),t(l);let r=l.flatMap(e=>e.events.map(e=>e.date.year).filter(e=>null!==e));if(r.length){let e=Math.min(...r),s=Math.max(...r);console.log("Setting year range:",e,s),n([e,s])}else console.log("No valid years found in the data")}catch(e){console.error("Error parsing GEDCOM:",e)}},l.onerror=e=>{console.error("Error reading file:",e)},l.readAsText(a)},accept:".ged",className:"hidden"}),(0,a.jsxs)(u,{onClick:()=>{var e;null===(e=N.current)||void 0===e||e.click()},children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Upload GEDCOM"]})]}),(0,a.jsxs)("div",{className:"w-48",children:[(0,a.jsx)(E,{value:r,min:1500,max:2024,step:1,onValueChange:n,className:"my-4"}),(0,a.jsxs)("div",{className:"flex justify-between mt-2 text-sm text-gray-600",children:[(0,a.jsx)("span",{children:r[0]}),(0,a.jsx)("span",{children:r[1]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Event Types:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u,{size:"sm",variant:J.includes("BIRT")?"default":"outline",onClick:()=>{X(e=>e.includes("BIRT")?e.filter(e=>"BIRT"!==e):[...e,"BIRT"])},className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"#38a169"}}),"Birth"]}),(0,a.jsxs)(u,{size:"sm",variant:J.includes("DEAT")?"default":"outline",onClick:()=>{X(e=>e.includes("DEAT")?e.filter(e=>"DEAT"!==e):[...e,"DEAT"])},className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"#e53e3e"}}),"Death"]}),(0,a.jsxs)(u,{size:"sm",variant:J.includes("RESI")?"default":"outline",onClick:()=>{X(e=>e.includes("RESI")?e.filter(e=>"RESI"!==e):[...e,"RESI"])},className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"#3182ce"}}),"Living"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"Show Relations:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u,{size:"sm",variant:"all"===q?"default":"outline",onClick:()=>K("all"),disabled:!k,children:"All"}),(0,a.jsx)(u,{size:"sm",variant:"ancestors"===q?"default":"outline",onClick:()=>K("ancestors"),disabled:!k,children:"Ancestors"}),(0,a.jsx)(u,{size:"sm",variant:"descendants"===q?"default":"outline",onClick:()=>K("descendants"),disabled:!k,children:"Descendants"})]})]}),(0,a.jsx)("div",{className:"w-48",children:(0,a.jsxs)(D,{open:_,onOpenChange:Q,children:[(0,a.jsx)(L,{asChild:!0,children:(0,a.jsxs)(u,{variant:"outline",className:"w-full justify-between",children:[k?(null===(e=s.find(e=>e.id===k))||void 0===e?void 0:e.name)||"Unknown":"Choose Root Person...",(0,a.jsx)(f.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsxs)(O,{className:"max-w-2xl",children:[(0,a.jsx)(U,{children:(0,a.jsx)(Z,{children:"Choose Person for Root"})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(z,{className:"rounded-lg border shadow-md",children:[(0,a.jsx)(A,{placeholder:"Search people...",value:F,onValueChange:P}),(0,a.jsxs)(M,{className:"max-h-[300px] overflow-y-auto",children:[(0,a.jsx)(T,{children:"No person found."}),(0,a.jsx)(I,{children:ed.map(e=>(0,a.jsx)(B,{value:e.name,className:"cursor-pointer hover:bg-accent pointer-events-auto",onSelect:()=>{C(e.id),P(""),Q(!1)},disabled:ee,children:(0,a.jsxs)("div",{className:"flex items-center gap-2 w-full",onClick:()=>{C(e.id),P("")},children:[k===e.id&&(0,a.jsx)(p.A,{className:"h-4 w-4 text-primary shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.name,ee&&k===e.id&&(0,a.jsx)(h.A,{className:"w-4 h-4 animate-spin"})]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.events.filter(e=>"BIRT"===e.type&&e.date.year).map(e=>e.date.year).join(", ")})]})]})},e.id))})]})]})}),(0,a.jsx)("div",{className:"flex flex-col gap-2 min-w-[120px]",children:(0,a.jsx)(u,{variant:"outline",onClick:()=>{C(null),Q(!1)},children:"Clear Selection"})})]})]})]})})]})}),(0,a.jsx)("div",{className:o("border-t",el?"hidden":""),children:(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>er(!el),className:"w-full h-8 rounded-none hover:bg-gray-50",children:(0,a.jsx)(x.A,{className:"h-4 w-4"})})}),el&&(0,a.jsx)(u,{variant:"outline",size:"lg",onClick:()=>er(!el),className:"absolute -left-10 top-0 h-10 w-10 bg-white shadow-lg rounded-l-lg border-r-0 flex items-center justify-center",children:(0,a.jsx)(g.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"absolute bottom-8 right-4 z-[1000] bg-white rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>{let e=en.current;e&&e.setZoom((e.getZoom()||7)+1)},className:"h-8 w-8 p-0",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>{let e=en.current;e&&e.setZoom((e.getZoom()||7)-1)},className:"h-8 w-8 p-0",children:(0,a.jsx)(j.A,{className:"h-4 w-4"})})]})}),0===s.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Upload a GEDCOM file to view your family map"}):(0,a.jsxs)(y.W,{center:[56.85,14],zoom:7,className:"h-full w-full",ref:en,zoomControl:!1,children:[(0,a.jsx)(w.e,{attribution:'<a href="https://www.maptiler.com/copyright/" target="_blank">\xa9 MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">\xa9 OpenStreetMap contributors</a>',url:"https://api.maptiler.com/maps/topo/256/{z}/{x}/{y}.png?key=PWo9ydkPHrwquRTjQYKg",maxZoom:19,tileSize:256}),(0,a.jsx)(G,{events:eo,onSelect:(e,s)=>c({person:e,event:s}),activeCoordinates:et}),(0,a.jsx)(W,{coordinates:(null==Y?void 0:Y.coordinates)||null,zoom:null==Y?void 0:Y.zoom})]}),d&&(0,a.jsx)(i,{className:o("absolute left-0 bottom-0 bg-white shadow-lg z-[1000] overflow-y-auto rounded-none","min-h-[300px]","max-h-[calc(100vh-2rem)]","w-[400px]"),children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"sticky top-0 z-10 bg-white border-b mb-2",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsx)("h3",{className:"font-bold text-xl text-gray-900",children:d.person.name}),(0,a.jsxs)(u,{size:"sm",variant:"ghost",onClick:()=>c(null),className:"h-8 w-8 p-0 -mt-1 -mr-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[ei(d.person.id)&&(0,a.jsx)("div",{className:"text-sm font-medium text-blue-600",children:ei(d.person.id)}),(0,a.jsx)("div",{className:"ml-auto",children:k!==d.person.id?(0,a.jsx)(u,{size:"sm",variant:"outline",onClick:()=>C(d.person.id),disabled:ee,className:"whitespace-nowrap text-xs",children:ee?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-3 h-3 mr-1 animate-spin"}),"Calculating..."]}):"Set as Root"}):(0,a.jsx)(u,{size:"sm",variant:"outline",onClick:()=>C(null),disabled:ee,className:"whitespace-nowrap text-xs",children:ee?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-3 h-3 mr-1 animate-spin"}),"Calculating..."]}):"Clear Root"})})]})]})}),(0,a.jsxs)("div",{className:"space-y-4 px-4 pb-4",children:[d.person.parents.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Parents"}),(0,a.jsx)("div",{className:"space-y-0",children:d.person.parents.map(e=>{let t=s.find(s=>s.id===e);return t&&(0,a.jsx)("button",{className:"w-full text-left px-2 py-1 hover:bg-gray-100 rounded-md text-blue-600 hover:text-blue-800",onClick:()=>{let e=t.events.filter(e=>0!==e.coordinates[0]&&0!==e.coordinates[1]&&"Unknown"!==e.place);e.length>0&&c({person:t,event:e[0]})},children:t.name},e)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[d.person.events.filter(e=>"BIRT"===e.type).map((e,s)=>(0,a.jsxs)("div",{className:o("p-3 rounded-lg border transition-colors",e===d.event?"bg-blue-100 border-blue-300 shadow-sm":"hover:bg-gray-50 border-transparent"),children:[(0,a.jsx)("div",{className:"font-medium text-blue-900",children:"Birth"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.date.from,e.date.to&&" to ".concat(e.date.to)]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm mt-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:e.place}),0!==e.coordinates[0]&&0!==e.coordinates[1]&&(0,a.jsx)(H,{coordinates:e.coordinates,onClick:()=>ec(e.coordinates,12)})]})]},s)),d.person.events.filter(e=>"DEAT"===e.type).map((e,s)=>(0,a.jsxs)("div",{className:o("p-3 rounded-lg border transition-colors",e===d.event?"bg-blue-100 border-blue-300 shadow-sm":"hover:bg-gray-50 border-transparent"),children:[(0,a.jsx)("div",{className:"font-medium text-blue-900",children:"Death"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.date.from,e.date.to&&" to ".concat(e.date.to)]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm mt-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:e.place}),0!==e.coordinates[0]&&0!==e.coordinates[1]&&(0,a.jsx)(H,{coordinates:e.coordinates,onClick:()=>ec(e.coordinates,12)})]})]},s)),d.person.events.some(e=>"RESI"===e.type)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Places of Residence"}),(0,a.jsx)("div",{className:"space-y-2",children:d.person.events.filter(e=>"RESI"===e.type).sort((e,s)=>null===e.date.year?1:null===s.date.year?-1:e.date.year-s.date.year).map((e,s)=>(0,a.jsxs)("div",{className:o("p-3 rounded-lg border transition-colors",e===d.event?"bg-blue-100 border-blue-300 shadow-sm":"hover:bg-gray-50 border-transparent"),children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.date.from,e.date.to&&" to ".concat(e.date.to)]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-700",children:e.place}),0!==e.coordinates[0]&&0!==e.coordinates[1]&&(0,a.jsx)(H,{coordinates:e.coordinates,onClick:()=>ec(e.coordinates,12)})]})]},s))})]})]}),d.person.children.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Children"}),(0,a.jsx)("div",{className:"space-y-2",children:d.person.children.map(e=>{let t=s.find(s=>s.id===e);return t&&(0,a.jsx)("button",{className:"w-full text-left px-2 py-1 hover:bg-gray-100 rounded-md text-blue-600 hover:text-blue-800",onClick:()=>{let e=t.events.filter(e=>0!==e.coordinates[0]&&0!==e.coordinates[1]&&"Unknown"!==e.place);e.length>0&&c({person:t,event:e[0]})},children:t.name},e)})})]})]})]})})]})}}}]);